<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 6.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="File-List" href="/web/20120208074829/http://www.macbiophotonics.ca/imagej/image_intensity_proce_files/filelist.xml">

<title>MBF_ImageJ - Intensity Processing</title>
<style>
<!--
div.Section1
	{page:Section1;}
h1
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:21.6pt;
	text-align:justify;
	text-indent:-21.6pt;
	page-break-before:always;
	page-break-after:avoid;
	tab-stops:list 21.6pt;
	font-size:12.0pt;
	font-family:Arial;
	font-variant:small-caps;
	font-style:italic;
	}
h2
	{margin-top:18.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:28.8pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:-28.8pt;
	tab-stops:list 28.8pt;
	font-size:10.0pt;
	font-family:Arial;
	}
h3
	{margin-top:6.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:40.5pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-indent:-36.0pt;
	page-break-after:avoid;
	tab-stops:list 40.5pt;
	font-size:10.0pt;
	font-family:Arial;
	font-style:italic;
	}
 li.MsoNormal
	{mso-style-parent:"";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:6.0pt;
	margin-left:0cm;
	text-align:justify;
	font-size:10.0pt;
	font-family:"Times New Roman"
	}
span.MsoFootnoteReference
	{vertical-align:super}
-->
</style>
<!--[if !mso]>
<style>
v\:*         { behavior: url(#default#VML) }
o\:*         { behavior: url(#default#VML) }
.shape       { behavior: url(#default#VML) }
</style>
<![endif]--><!--[if gte mso 9]>
<xml><o:shapedefaults v:ext="edit" spidmax="1027"/>
</xml><![endif]-->
</head>

<body topmargin="0" leftmargin="0">



<table border="1" cellspacing="0" width="693" id="AutoNumber1" height="427" style="border-collapse: collapse; border-width: 0" cellpadding="0">
  <tr>
    <td width="211" height="138" style="border-style: none; border-width: medium" valign="bottom" rowspan="2" bgcolor="#960033" background="logo4.jpg" colspan="2">
    <p style="margin-top: 0; margin-bottom: 0">&nbsp;</td>
    <td width="354" height="101" style="border-style: none; border-width: medium" nowrap valign="bottom">
    <p align="center" style="margin-bottom: 12"><i><b>
      <font color="#960033" face="Arial" size="5">Online Manual for the<br>
      <font color="#960033">MBF-ImageJ collection</font></font></b></i></td>
    <td width="280" height="101" style="border-style: none; border-width: medium" nowrap valign="bottom">
    <p style="margin-bottom: 12" align="right">
	<img border="0" src="imagej4microscopy.jpg" width="258" height="54"><b><font face="Comic Sans MS" color="#243A68" size="2"><a target="_blank" href="http://rsb.info.nih.gov/ij/"><br>
    Link to
    ImageJ homepage</a></font></b></td>
  </tr>
  <tr>
    <td width="634" height="35" style="border-style: none; border-width: medium" nowrap valign="bottom" colspan="2" background="grad9.jpg">&nbsp;</td>
  </tr>
  <tr>
    <td width="10" valign="top" nowrap style="border-style: none; border-width: medium" bgcolor="#960033" background="grad10-1.jpg" height="285">


    &nbsp;</td>
    <td width="206" valign="top" nowrap style="border-style: none; border-width: medium" bgcolor="#960033" background="grad10.jpg" height="285">
<script type='text/javascript'>

//HV Menu v5.411- by Ger Versluis (http://www.burmees.nl/)
//Submitted to Dynamic Drive (http://www.dynamicdrive.com)
//Visit http://www.dynamicdrive.com for this script and more

function Go(){return}

</script>
<script type='text/javascript' src='exmplmenu_var.js'></script>
<script type='text/javascript' src='menu_com.js'></script>
<noscript>Your browser does not support script</noscript></td>
    <td width="634" height="285" valign="top" style="border-style: none; border-width: medium" nowrap colspan="2">

<div class="Section1" style="width: 606; height: 604">

<div class="Section1" style="width: 606; height: 679">

<h1><a name="_Ref43545691"><span lang="en-gb">7</span><span lang="EN-GB"><span style="font-style: normal; font-variant: normal; font-weight: normal; font-size: 7.0pt; ">
</span>Image intensity Processing</span></a><span lang="EN-GB"> </span></h1>
<h2 style="margin-top: 9; margin-bottom: 3"><a name="intensity_BnC"><span lang="en-gb">7</span></a><span lang="EN-GB"><a name="intensity_BnC">.1<span style="font-style: normal; font-variant: normal; font-weight: normal; "><font size="2">
</font>
</span>Brightness and Contrast</a></span></h2>
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border-width: 0" bordercolor="#111111" width="100%" id="AutoNumber10">
  <tr>
    <td width="77%" style="border-style: none; border-width: medium">
<p class="MsoNormal" style="margin-right: 12; margin-top:9; margin-bottom:3">
<font face="Arial" size="2"><span lang="EN-GB">
The
<i>Brightness and Contrast </i>window (Hotkey: Shift+C; menu command “<i>Image/Adjust/Brightness 
and Contrast…”</i>) will allow you to change the way the image is displayed. The 
x-axis of the plot represents the pixel intensities in the image; the y-axis 
represents the intensity that they are displayed (bottom of y-axis is display 
black; top is display white). Initially, there is a linear relationship between 
the image intensity and the display intensity. Increase the minimum value to 
display your image background as black (i.e.) zero and decrease the maximum 
value to display the brightest objects in your image as white. This is best 
achieved in a greyscale image by loading the “HiLo LUT” (“<i>Plugins/LUT/Hi Lo 
Indicator…”</i>; hotkey: F1).</span></font></p>
<p class="MsoNormal" style="margin-right: 12; margin-top:9; margin-bottom:3">
<font face="Arial" size="2"><span lang="EN-GB">
The <i>Auto </i>button applies a linear histogram stretch (a.k.a. <i>
Normalisation</i>), i.e. it sets the displayed value to match the maximum and 
minimum intensity in the image. Clicking the Auto button again will allow 
increasing amounts of saturation. By clicking the <i>
Apply </i>button the values in the image are changed to match their displayed 
value. Do not do this prior to quantifying intensity values! If you are 
processing a stack, you will be given the option to apply this adjustment to the 
entire stack. </span></font></p>
<p class="MsoNormal" style="margin-right: 12; margin-top:9; margin-bottom:3">
<font face="Arial" size="2"><span lang="EN-GB">
If <i>Auto</i> does not produce a desirable result, select a region of the cell 
plus some background with an ROI tool, then hit the <i>Auto</i> button again. It 
will then do a stretch based on the intensities within the ROI.</span></font></p>
<p class="MsoNormal" style="margin-right: 12; margin-top:9; margin-bottom:3">
<font face="Arial" size="2"><span lang="EN-GB">
If you prefer the movie to be displayed as “White and Black” rather than “Black 
and White”, the image display can be “inverted” by the command “<i>Image/Color 
Tables/Invert-LUT</i>”. The command “<i>Edit/Invert…</i>” inverts the pixel <i>
values</i> not just the way the image is displayed.</span></font></p>
    </td>
    <td width="23%" valign="top" style="border-style: none; border-width: medium">
    <p style="margin-top: 9; margin-bottom: 3"><font size="2">
    <img border="0" src="image_31.jpg" width="130" height="295"></font></td>
  </tr>
</table>
<h2 style="margin-top: 9; margin-bottom: 3"><span lang="EN-GB"><a name="intensity_nonLinear">7.2<span style="font-style: normal; font-variant: normal; font-weight: normal; "><font size="2">
</font>
</span>Non-linear 
contrast stretching</a></span></h2>
<h3 style="margin-top: 9; margin-bottom: 3"><a name="_Toc76807436"><span lang="EN-GB">7.2.<span style="font-variant: normal; ">1</span><span style="font-style: normal; font-variant: normal; font-weight: normal; "><font size="2">
</font>
</span></span></a><span lang="en-gb">Equalization</span></h3>
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border-width: 0" bordercolor="#111111" width="100%" id="AutoNumber2">
  <tr>
    <td width="81%" style="border-style: none; border-width: medium" valign="top">
<p class="MsoNormal" style="margin-right: 12; margin-top:9; margin-bottom:3">
<font face="Arial" size="2"><span lang="EN-GB">More control of the brightness and 
contrast adjustment can be achieved with the <i>“Process/Enhance contrast”</i> 
menu command. Here, when applied to a stack, it applies the adjustment based on 
each slice’s histogram, not just the one currently displayed as is done with the
<i>Brightness and Contrast </i>window.</span></font></p>
<p class="MsoNormal" align="left" style="text-align: left; margin-right:12; margin-top:9; margin-bottom:3">
<font face="Arial" size="2"><span lang="EN-GB">
“Equalisation” applies a non-linear stretch of the histogram based on the square 
root of the intensity (see online guide to image processing:
<a href="http://www.dai.ed.ac.uk/HIPR2/histeq.htm" style="color: blue; text-decoration: underline; text-underline: single">
http://www.dai.ed.ac.uk/HIPR2/histeq.htm</a>). </span></font></p>
<p class="MsoNormal" align="left" style="text-align: left; margin-right:12; margin-top:9; margin-bottom:3">
<font face="Arial" size="2"><span lang="EN-GB">
The “Normalize” option performs a simple 
linear stretch on the image in a similar way to the “<i>Auto”</i> option in the 
Brightness and Contrast window, except that when applied to a stack each slice 
in stack is adjusted differently based on the slice’s histogram. </span></font></p>
    </td>
    <td width="19%" style="border-style: none; border-width: medium" valign="top">
    <p style="margin-top: 9; margin-bottom: 3"><font size="2">
    <img border="0" src="image_32.jpg" width="117" height="118"> </font>
    </td>
  </tr>
</table>
<p style="margin-top: 9; margin-bottom: 3"><font size="2">
<img border="0" src="image_33.gif" width="540" height="137"></font></p>
<h3 style="margin-top: 9; margin-bottom: 3"><a name="_Toc76807436"><span lang="EN-GB">7.2.<span style="font-variant: normal; ">2</span><span style="font-style: normal; font-variant: normal; font-weight: normal; "><font size="2">
</font>
</span></span></a><span lang="en-gb">Gamma</span></h3>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">This can be though of as a non-linear 
histogram adjustment. Faint objects can be made more intense without saturating 
bright objects (gamma &lt;1). Similarly, medium-intensity objects can be made 
fainter without dimming the bright objects (gamma &gt; 1). The intensity of each 
pixel is “raised to the power” of the gamma value and then scaled to 8-bits or 
the min and max of 16-bit images. </span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">For 8 bit images; New intensity = 255 ×<i> 
[(old intensity÷255)<sup> gamma</sup></i>]</span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">Gamma can be adjusted via the “<i>Process/Math/Gamma”</i> 
command or the “<i><span style="color: navy">Plugins/Utilities/Gamma Scroll-bar</span></i><span style="color: navy">”</span> 
plugin. The latter will open up a new window copy of your image and you can 
adjust the gamma with the scroll bar. Click on “<i>Done”</i> when you are 
finished. This is a bit flaky and doesn’t react well if you change images in 
mid-adjust! This does not work on stacks. You can use the Scroll-bar to 
determine the desired gamma value on one slice of your stack, and then apply 
this gamma value to the stack via the “<i>Process/Math/Gamma”</i> command. </span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><i><span lang="EN-GB"><!--[if gte vml 1]><v:shapetype id="_x0000_t75"
 coordsize="21600,21600" o:spt="75" o:preferrelative="t" path="m@4@5l@4@11@9@11@9@5xe"
 filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_s1029" type="#_x0000_t75" style='width:.75pt;
 height:.75pt'>
 <v:imagedata src="" o:title=""/>
</v:shape><![endif]--></span></i></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB"><!--[if gte vml 1]><v:shape id="_x0000_s1028" type="#_x0000_t75"
 style='width:.75pt;height:.75pt'>
 <v:imagedata src="" o:title=""/>
</v:shape><![endif]--><!--[if gte vml 1]><v:shape id="_x0000_s1027" type="#_x0000_t75"
 style='width:.75pt;height:.75pt'>
 <v:imagedata src="" o:title=""/>
</v:shape><![endif]--></span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3"><span lang="EN-GB">
<font size="2"><img border="0" src="image_34.jpg" width="488" height="316"><!--[if gte vml 1]><v:shape id="_x0000_s1026" type="#_x0000_t75"
 style='width:.75pt;height:.75pt'>
 <v:imagedata src="" o:title=""/>
</v:shape><![endif]--><!--[if gte vml 1]><v:shape id="_x0000_s1025" type="#_x0000_t75"
 style='width:.75pt;height:.75pt'>
 <v:imagedata src="" o:title=""/>
</v:shape><![endif]--></font></span></p>
<h2 style="margin-top: 9; margin-bottom: 3"><a name="intensity_filter">7.4 Filtering</a></h2>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">See the online reference:
<a href="http://www.dai.ed.ac.uk/HIPR2/filtops.htm" style="color: blue; text-decoration: underline; text-underline: single">
http://www.dai.ed.ac.uk/HIPR2/filtops.htm</a> for a simple explanation of 
digital filtering.</span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">Filters can be found under the menu item 
“<i>Process/Filters...</i>”<i>.</i> Typically use a “<i>Radius (pixels)</i>” of 
1 which equates to a 3×3 “kernel” – see online reference.</span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><i><span lang="EN-GB">Mean filter</span></i><span lang="EN-GB">: 
the pixel is replaced with the average of it and its neighbours within the 
radius. The menu item “<i>Process/Smooth</i>” is a 3×3 mean filter. </span>
</font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><i><span lang="EN-GB">Gaussian filter</span></i><span lang="EN-GB">: 
The is similar to smoothing but replaces the pixel with a pixel of value 
proportional to a normal distribution of it’s neighbours – not explained well, I 
know, but you’ve probably skipped the online reference and you need to read that 
to understand the way the filter works properly.</span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><i><span lang="EN-GB">Median filter</span></i><span lang="EN-GB">: 
the pixel is replaced with the median of it and its adjacent neighbours. This 
removes noise and <i>preserves boundaries</i> better than simple mean filtering, 
but can look odd. (The menu item “<i>Process/Noise/Despeckle</i>” is a 3×3 
median filter).</span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><i><span lang="EN-GB" style="color: navy">Kalman filter</span></i><!--[if supportFields]><span lang="EN-GB"> 
XE &quot;<i><span style="color: navy">Kalman filter: </span></i>Christopher Philip 
Mauer (<a href="mailto:cpmauer@northwestern.edu" style="color: blue; text-decoration: underline; text-underline: single">cpmauer@northwestern.edu</a>)&quot;
</span><![endif]--></font><!--[if supportFields]><![endif]-->
<font face="Arial" size="2"><span lang="EN-GB">: 
Sophisticated filtering for time-course experiments – a sort of “weighted 
running average”. Best used if the sample frequency is higher than the “event” 
frequency i.e. slowly occurring events. Otherwise you get odd, blurry results. “<i><span style="color: navy">Process/Filter/Kalman 
Stack…</span>”.</i></span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3"><font face="Arial"><i><span lang="EN-GB" style="color: navy">
<font size="2">Sigma filter</font></span></i><span lang="EN-GB"><font size="2">: 
A modification on the standard mean filter but preserves edges better – can be 
though of as a “gentle smooth”. The user specifies the kernel size, the Sigma 
width and the minimum number of pixels to include. A <i>Sigma</i> value for the 
kernel is calculated (based on the variance and mean of the intensities) and 
only pixels within this <i>Sigma range</i> (= <i>Sigma</i> × the user defined <i>
Sigma Width </i>scaling factor) are used to calculate the mean. If there are too 
few pixels (exact number set in the user dialog: <i>Minimum number of pixels</i>) 
in the kernel that are within the Sigma range then the central pixel which is 
assumed to be spuriously low or high and the mean of the rest of the kernel is 
taken. Increasing the <i>Sigma width</i> and the <i>minimum number of pixels</i> 
results in increased smoothing and loss of edges. This plugin is under 
development, please send me any feedback. “</font><i><font size="2"><span style="color: navy">Process/Filter/Sigma 
Filter…</span>” </font> </i><font size="2">J.S. Lee, 
Digital Image Smoothing and the Sigma Filter, Computer Vision, Graphics, and 
Image Processing 24, (1983) p. 255-269.</font></span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3"><font style="color: navy" face="Arial"><i>
<font size="2">Anisotropic 
Diffusion.</font></i></font><font size="2" face="Arial"> This is an edge preserving smoothing 
filter. </font></p>
<p style="margin-top: 9; margin-bottom: 3"><font face="Arial" size="2"><span lang="EN-GB">
<img border="0" src="image_2.jpg" width="647" height="342">&nbsp;</span></font></p>
<h2 style="margin-top: 9; margin-bottom: 3"><span lang="EN-GB"><a name="intensity_BG">7.5<span style="font-style: normal; font-variant: normal; font-weight: normal; "><font size="2">
</font>
</span>Background correction</a></span></h2>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">Background correction can be done in 
several ways and is facilitated if the grey image has the “<i><span style="color: navy">Plugins/LUT/Hi 
Lo indicator</span></i>” (Hotkey: F1) LUT loaded. This displays the zero values 
blue and the 255 white values red. </span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">If the background is relatively even 
across the image, it is most simply remove with the <i>Brightness&amp;Contrast</i> 
command – slowly raise the <i>Minimum</i> value until most of the background is 
displayed blue. The press the <i>Apply </i>button to change the grey-values and 
remove the background.</span></font></p>
<h3 style="margin-top: 9; margin-bottom: 3">7.5.1 Rolling-Ball background correction</h3>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">For uneven background the menu command “<i>Process/Subtract 
background</i>” can be used. This menu command removes uneven background from 
images using a “rolling ball” algorithm. The radius should be set to at least 
the size of the largest object that is <i>not</i> part of the background. It can 
also be used to remove background from gels where the background is white. 
Running the command several times may produce better results. </span></font></p>
<table border="0" cellspacing="1" style="border-collapse: collapse" bordercolor="#FFFFFF" width="89%" id="AutoNumber8">
  <tr>
    <td width="33%">
<p style="margin-top: 9; margin-bottom: 3">
<b><span lang="EN-GB" style="font-family: Arial">
<font size="2">&nbsp;RAW </font> </span></b></td>
    <td width="23%">
    <p style="margin-top: 9; margin-bottom: 3">&nbsp;</td>
    <td width="44%">
<p style="margin-top: 9; margin-bottom: 3">
<b><span lang="EN-GB" style="font-family: Arial">
    <font size="2">“</font><i><font size="2">Process/Subtract 
Background…”</font></i></span></b></td>
  </tr>
  <tr>
    <td width="33%">
    <p style="margin-top: 9; margin-bottom: 3"><font size="2">
    <img border="0" src="image_35.jpg" width="192" height="193"></font></td>
    <td width="23%">
    <p style="margin-top: 9; margin-bottom: 3"><font size="2">
    <img border="0" src="image_36.jpg" width="144" height="109"></font></td>
    <td width="44%">
    <p style="margin-top: 9; margin-bottom: 3"><font size="2">
    <img border="0" src="image_37.jpg" width="192" height="193"></font></td>
  </tr>
</table>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3"><span lang="EN-GB">
<font size="2">&nbsp; </font> </span></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">Once 
the background has been evened, final adjustments can be made with the <i>
Brightness&amp;Contrast</i> control. </span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">&nbsp;</p>
<table border="0" cellspacing="1" style="border-collapse: collapse" bordercolor="#FFFFFF" width="86%" id="AutoNumber9">
  <tr>
    <td width="33%">
    <p style="margin-top: 9; margin-bottom: 3"><font size="2">
    <img border="0" src="image_38.jpg" width="192" height="193"></font></td>
    <td width="33%">
    <p style="margin-top: 9; margin-bottom: 3"><font size="2">
    <img border="0" src="image_39.jpg" width="168" height="139"></font></td>
    <td width="34%">
    <p style="margin-top: 9; margin-bottom: 3"><font size="2">
    <img border="0" src="image_40.jpg" width="96" height="215"></font></td>
  </tr>
</table>
<h3 style="margin-top: 9; margin-bottom: 3">
<a name="7.5.2_ROI_background_correction_">7.5.2 ROI background correction</a></h3>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">The rolling-ball 
algorithm is time consuming. If the background is even across the field of view it is possible to select a background 
region of interest and subtract the mean value of this area for each slice from 
each slice. Use the selection tools to select an area of background and run the 
menu command “<i><span style="color: #333399">Plugins/ROI/BG 
Subtraction from ROI</span>”</i>. This macro will subtract the mean of the ROI 
from the image plus an additional value equal to the standard deviation of the 
ROI multiplied by the scaling factor you enter (3 by default).</span></font></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3"><span lang="en-gb">
<font face="Arial" size="2">i.e. it subtracts 
[mean + (sd×scalingfactor)]</font></span></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3"><span lang="en-gb">
<font face="Arial" size="2">This macro also works 
with stacks and so can be used with time-courses with varying background.</font></span></p>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">&nbsp;</span></font></p>
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border-width: 0" bordercolor="#FFFFFF" width="66%" id="AutoNumber4">
  <tr>
    <td width="21%" style="border-style: none; border-width: medium" align="center" valign="top">
    <p style="margin-top: 9; margin-bottom: 3">
    <span lang="EN-GB" style="font-family: Arial; font-weight:700">
    <font size="2">Before correction</font></span></td>
    <td width="23%" style="border-style: none; border-width: medium" align="center" valign="top">
    <p style="margin-top: 9; margin-bottom: 3">
    <span lang="EN-GB" style="font-family: Arial; font-weight:700">
    <font size="2">&nbsp;Background intensity over time </font></span></td>
    <td width="56%" style="border-style: none; border-width: medium" align="center" valign="top">
    <p style="margin-top: 9; margin-bottom: 3">
    <span lang="EN-GB" style="font-family: Arial; font-weight:700">
    <font size="2">After “<i>ROI_BG_Correction</i>”</font></span></td>
  </tr>
  <tr>
    <td width="21%" style="border-style: none; border-width: medium" align="center" valign="top">
    <p style="margin-top: 9; margin-bottom: 3"><font size="2">
    <img border="0" src="image_41.gif" width="204" height="94"></font></td>
    <td width="23%" style="border-style: none; border-width: medium" align="center" valign="top">
    <p style="margin-top: 9; margin-bottom: 3"><font size="2">
    <img border="0" src="image_42.gif" width="199" height="94"></font></td>
    <td width="56%" style="border-style: none; border-width: medium" align="center" valign="top">
    <p style="margin-top: 9; margin-bottom: 3"><font size="2">
    <img border="0" src="image_43.gif" width="199" height="94"></font></td>
  </tr>
</table>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3"><span lang="EN-GB" style="font-family: Arial">
<font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font></span></p>
<h2 style="margin-top:9; margin-bottom:3"><span lang="EN-GB"><a name="intensity_flat">7.1<span style="font-style:normal; font-variant:normal; font-weight:normal; "><font size="2">
</font>
</span>Flat-field correction</a></span></h2>
<h3 style="margin-top: 9; margin-bottom: 3"><a name="_Toc76807487"><span lang="EN-GB">7.1.1<span style="font-style:normal; font-variant:normal; font-weight:normal; "><font size="2">
</font>
</span>Proper correction</span></a></h3>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">This technique is applied to brightfield 
images. Uneven illumination, dirt/dust on lenses can result in a poor quality 
image. This can be corrected by acquiring a “flat-field” reference image <i>with 
the same intensity illumination as the experiment</i>. The flat field image 
should, ideally, be a field of view of the coverslip without any cells/debris. 
This is often not possible with the experimental coverslip, so a fresh coverslip 
may be used with approximately the same amount of buffer as the experiment. With 
fixed-specimens try removing the slide completely </span></font></p>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#FFFFFF" width="57%" id="AutoNumber7" height="37">
  <tr>
    <td width="100%" height="17" colspan="3">
    <p style="margin-top: 9; margin-bottom: 3"><font size="2">
    <img border="0" src="image_44.gif" width="578" height="156"></font></td>
  </tr>
  <tr>
    <td width="33%" height="19" align="center">
    <p style="margin-top: 9; margin-bottom: 3"><font face="Arial" size="2"><b>
    RAW</b></font></td>
    <td width="33%" height="19" align="center">
    <p style="margin-top: 9; margin-bottom: 3"><font face="Arial" size="2"><b>
    Flat-field</b></font></td>
    <td width="34%" height="19" align="center">
    <p style="margin-top: 9; margin-bottom: 3"><font face="Arial" size="2"><b>&nbsp;Processed</b></font></td>
  </tr>
</table>
<table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#FFFFFF" width="100%" id="AutoNumber6">
  <tr>
    <td width="22%">
    <p style="margin-top: 9; margin-bottom:3">
<font face="Arial" size="2"><span lang="EN-GB">
    <img border="0" src="image_1.jpg" align="left" vspace="3" width="211" height="200"></span></font></td>
    <td width="78%" valign="top">
<p class="MsoNormal" style="text-indent: -18.0pt; margin-left: 18.0pt; margin-right: 0cm; margin-top: 9; margin-bottom: 3">
<span lang="EN-GB"><font face="Arial" size="2">1.</font><span style="font-style:normal; font-variant:normal; font-weight:normal; font-family:Arial"><font size="2">
</font>
</span><font face="Arial" size="2">Open both experimental image and flat-field image.</font></span></p>
<p class="MsoNormal" style="text-indent: -18.0pt; margin-left: 18.0pt; margin-right: 0cm; margin-top: 9; margin-bottom: 3">
<span lang="EN-GB"><font face="Arial" size="2">2.</font><span style="font-style:normal; font-variant:normal; font-weight:normal; font-family:Arial"><font size="2">
</font>
</span><font face="Arial" size="2">“<i>Select all</i>” of the flat-field image (hotkey: 
A) and measure the average intensity (hotkey: M). This value will appear in the 
results window and represents your k1 value below.</font></span></p>
<p class="MsoNormal" style="text-indent: -18.0pt; margin-left: 18.0pt; margin-right: 0cm; margin-top: 9; margin-bottom: 3">
<span lang="EN-GB"><font face="Arial" size="2">3.</font><span style="font-style:normal; font-variant:normal; font-weight:normal; font-family:Arial"><font size="2">
</font>
</span><font size="2" face="Arial">Use the “<i>Image Calculator plus</i>” plugin (“<i><span style="color:navy">Analyse</span></i><span style="color:navy">/<i>Tools/Calculator 
plus</i></span>”</font></span><font face="Arial"><font size="2"><!--[if supportFields]><span lang="EN-GB" style="color:navy"> 
XE &quot;<i>Calculator plus: </i></span></font><span lang="EN-GB">
<font size="2">Wayne Rasdband</font><span style="color:navy"><font size="2">&quot;
</font>
</span></span><![endif]--></font><!--[if supportFields]><![endif]-->
<font face="Arial" size="2"><span lang="EN-GB">
).</span></font></p>
<p class="MsoNormal" style="text-indent: -18.0pt; margin-left: 18.0pt; margin-right: 0cm; margin-top: 9; margin-bottom: 3">
<span lang="EN-GB"><font face="Arial" size="2">4.</font><span style="font-style:normal; font-variant:normal; font-weight:normal; font-family:Arial"><font size="2">
</font>
</span><font face="Arial" size="2">i1 = experimental image; i2 = flat-field image; k1 = mean flat-field 
intensity; k2 = 0. Select the &quot;<i>Divide&quot; </i>operation.</font></span></p>
<p class="MsoNormal" style="margin-bottom:3; margin-top:9">
<font face="Arial" size="2"><span lang="EN-GB">This can 
also be done using the “<i>Process/Image Calculator” </i>function and ensuring 
the “32-bit Result” option is checked. You will then need to adjust the 
brightness and contrast and change the image to 8-bit.</span></font></p>
    <p style="margin-top: 9; margin-bottom:3">&nbsp;</td>
  </tr>
</table>
<h3 style="margin-top: 9; margin-bottom: 3"><a name="_Toc76807488"><span lang="EN-GB">7.1.2<span style="font-style:normal; font-variant:normal; font-weight:normal; "><font size="2">
</font>
</span>Pseudo-correction</span></a></h3>
<table border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border-width: 0" bordercolor="#FFFFFF" width="100%" id="AutoNumber3">
  <tr>
    <td width="100%" style="border-style: none; border-width: medium" colspan="2">
<p class="MsoNormal" style="margin-left:12; margin-top:9; margin-bottom:3">
<font size="2"><img border="0" src="image_3.gif" align="left" width="289" height="201"></font><font face="Arial" size="2"><span lang="EN-GB">Often 
it is not possible to obtain a flat-field reference image. However, it is still 
possible to correct for illumination intensity (although not small defects such 
as dust) by making a “pseudo-flat field” image by performing a large-kernel 
filter on the image to be corrected. This is particularly useful for DIC images 
where there is an intrinsic, and distracting, gradient in illumination.</span></font></p>
<p class="MsoNormal" style="margin-left:12; margin-top:9; margin-bottom:3">
<font face="Arial" size="2"><span lang="EN-GB">The menu 
command “<i><span style="color:navy">Process</span></i><span style="color:navy">/<i>Filters/Pseudo-flat 
field</i></span></span><!--[if supportFields]><span lang="EN-GB"> XE &quot;<i><span style="color:navy">Process</span></i><span style="color:navy">/<i>Filters/Pseudo-flat 
field:</i></span></span>Tony Collins<span lang="EN-GB">&quot; </span><![endif]-->
</font><!--[if supportFields]>
<![endif]--><font face="Arial" size="2"><span lang="EN-GB">” automates this process. You are prompted to 
enter the kernel size for the mean filter; try the default value of 50 first. 
You can opt to keep the flat field image open to check whether the kernel is 
large enough. The objects should not be visible in the flat field image.</span></font></p>
<p class="MsoNormal" style="margin-left:12; margin-top:9; margin-bottom:3"><span lang="en-gb">
<font face="Arial" size="2">This can also be used with stacks for brightfield 
time-courses that vary in intensity with time. This is time consuming though.</font></span></p>
    </td>
  </tr>
  <tr>
    <td width="32%" style="border-style: none; border-width: medium">
    <p style="margin-top: 9; margin-bottom:3"><font size="2">
    <img border="0" src="image_4.gif" width="337" height="150"></font></td>
    <td width="68%" valign="top" style="border-style: none; border-width: medium">
    <p style="margin-left: 12; margin-top: 9; margin-bottom: 3">
      <span lang="EN-GB" style="font-family:Arial; mso-bidi-font-weight:normal">
      <font size="2">The first RAW image (top) pseudo-flat field corrected. 
      Here the pseudo-flat field corrects for the uneven illumination but does 
      not correct the dust specks. Compare this with the result of a proper 
      flat-field correction above.</font></span></td>
  </tr>
</table>
<p class="MsoNormal" style="margin-left:0; text-align:left; margin-top:9; margin-bottom:3">
<font face="Arial" size="2"><i><span lang="EN-GB">&nbsp;</span></i></font></p>
<h3 style="margin-top: 9; margin-bottom: 3"><a name="7.1.3 FFT background correction"><font face="Arial"><i>
<span lang="en-gb"><b>7.1.3 FFT background </b></span></i></font>correction</a></h3>
<p class="MsoNormal" style="margin-left:0; text-align:left; margin-top:9; margin-bottom:3"><span lang="en-gb">
<font face="Arial" size="2">We sometimes see uneven illumination and also horizontal 
&quot;scan lines&quot; in transmitted light images acquired with confocal microscopes. 
This background can be corrected using the native FFT bandpass function (<i>Process/FFT/Bandpass...).</i></font></span></p>
<p class="MsoNormal" style="margin-left:0; text-align:left; margin-top:9; margin-bottom:3"><span lang="en-gb">
<font face="Arial" size="2">Experiment with the settings to optimise the filtering.</font></span></p>
<p class="MsoNormal" style="margin-left:0; text-align:left; margin-top:9; margin-bottom:3">
<font size="2">
<img border="0" src="image_45.jpg" width="604" height="203"></font></p>
<p class="MsoNormal" style="margin-left:198.0pt; text-align:left; margin-top:9; margin-bottom:3">&nbsp;</p>
<h2 style="margin-top: 9; margin-bottom: 3"><span lang="EN-GB"><a name="intensity_mask">7.2<span style="font-style:normal; font-variant:normal; font-weight:normal; "><font size="2">
</font>
</span>Masking unwanted regions</a></span></h2>
<h3 style="margin-top:9; margin-bottom:3"><a name="_Toc76807490"><span lang="EN-GB">7.2.1<span style="font-style:normal; font-variant:normal; font-weight:normal; "><font size="2">
</font>
</span>Simple masking</span></a></h3>
<p class="MsoNormal" style="margin-bottom:3; margin-top:9">
<font face="Arial" size="2"><span lang="EN-GB">Draw around 
the area you want with one of the ROI tools then use: “<i>Edit/Clear outside</i>”<i>.
</i>This will change area outside the selected region to the background value.
</span></font></p>
<p class="MsoNormal" style="margin-bottom:3; margin-top:9">
<font face="Arial" size="2"><span lang="EN-GB">&nbsp;</span></font></p>
<h3 style="margin-top: 9; margin-bottom: 3"><a name="_Toc76807491"><span lang="EN-GB">7.2.2<span style="font-style:normal; font-variant:normal; font-weight:normal; "><font size="2">
</font>
</span>Complex masking</span></a></h3>
<p class="MsoNormal" style="margin-top: 9; margin-bottom: 3">
<font face="Arial" size="2"><span lang="EN-GB">A more sophisticated masking can be done 
by “thresholding” the image and subtracting this new binary image from the 
original.</span></font></p>
<p class="MsoNormal" style="text-indent: -17.85pt; margin-left: 17.85pt; margin-right: 0cm; margin-top: 9; margin-bottom: 3">
<span lang="EN-GB"><font face="Arial" size="2">1.</font><span style="font-style:normal; font-variant:normal; font-weight:normal; font-family:Arial"><font size="2">
</font>
</span><font face="Arial" size="2">Duplicate the image (if it’s a stack it’s worthwhile generating a 
“average projection” of a few frames).</font></span></p>
<p class="MsoNormal" style="text-indent: -17.85pt; margin-left: 17.85pt; margin-right: 0cm; margin-top: 9; margin-bottom: 3">
<span lang="EN-GB"><font face="Arial" size="2">2.</font><span style="font-style:normal; font-variant:normal; font-weight:normal; font-family:Arial"><font size="2">
</font>
</span><font face="Arial" size="2">Threshold this image using the menu command “<i>Image/Adjust/Threshold</i>” 
(hotkey Shift+T). </font> </span></p>
<p class="MsoNormal" style="text-indent: -17.85pt; margin-left: 17.85pt; margin-right: 0cm; margin-top: 9; margin-bottom: 3">
<span lang="EN-GB"><font face="Arial" size="2">3.</font><span style="font-style:normal; font-variant:normal; font-weight:normal; font-family:Arial"><font size="2">
</font>
</span><font face="Arial" size="2">Hit the Auto button and then adjust the sliders until cells are all 
highlighted red. </font> </span></p>
<p class="MsoNormal" style="text-indent: -17.85pt; margin-left: 17.85pt; margin-right: 0cm; margin-top: 9; margin-bottom: 3">
<span lang="EN-GB"><font face="Arial" size="2">4.</font><span style="font-style:normal; font-variant:normal; font-weight:normal; font-family:Arial"><font size="2">
</font>
</span><font face="Arial" size="2">Then click “<i>Apply</i>”. Check the tick box: “black foreground, white 
background”. You should now have a white and black image with your cells black 
and background white. If you have white cells and black background, invert the 
image with “<i>Edit/Invert</i>”.</font></span></p>
<p class="MsoNormal" style="text-indent: -17.85pt; margin-left: 17.85pt; margin-right: 0cm; margin-top: 9; margin-bottom: 3">
<span lang="EN-GB"><font face="Arial" size="2">5.</font><span style="font-style:normal; font-variant:normal; font-weight:normal; font-family:Arial"><font size="2">
</font>
</span><font face="Arial" size="2">This can be smoothed (“<i>Process/Smooth</i>”) and the black area 
enlarged slightly with “<i>Process/Binary/Dilate</i>” to give a better mask</font></span></p>
<p class="MsoNormal" style="text-indent: -17.85pt; margin-left: 17.85pt; margin-right: 0cm; margin-top: 9; margin-bottom: 3">
<span lang="EN-GB"><font face="Arial" size="2">6.</font><span style="font-style:normal; font-variant:normal; font-weight:normal; font-family:Arial"><font size="2">
</font>
</span><font face="Arial" size="2">Using the regular Image calculator “<i>Process/Image calculator</i>” 
subtract this black and white “mask” image from your original image/stack.
</font>
</span></p>
<p class="MsoNormal" style="margin-bottom:3; margin-top:9">
<font face="Arial" size="2"><span lang="EN-GB">&nbsp;</span></font></p>
  <p>&nbsp;</div>

  <font face="Arial"><span lang="EN-GB">
</div>
</span></font></td>
  </tr>
</table>


</body>

</html>




<!--
     FILE ARCHIVED ON 7:48:29 Feb 8, 2012 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 16:32:07 Mar 6, 2013.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
